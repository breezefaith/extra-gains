这项作业是基于一个简化的数据库来管理汽车保险公司的政策信息。该公司出售不同类型的量身定制的保险政策，保护损失，损害，伤害等涉及机动车辆(保险项目)。例如，该公司可能出售greenslip、第三方财产损害计划或定制保险的综合计划。
保险单是针对一种或多种保险项目的。在本任务中，我们只考虑客户为个人的情况(即我们不考虑公司保险计划)。保单是由公司员工(代理人)直接销售的。投保人可以是多人，例如一个人和他/她的配偶或家庭。
销售保险的第一步是在代理人的协调下起草一份保单。一份保单可能包括几项保险;例如，火灾、被盗、第三方责任等。代理将与客户机联系，以确定客户机需要哪些覆盖率，并将该信息输入数据库。在那之后，保险公司有一个评价者团队(可能包含不止一个评价者)，他们决定每个保险的费率。费率是根据车辆，提供的特殊保险范围，以及被保险人给予的任何资格(细则)。如果评级团队在无法提供合理费率的情况下拒绝承保(例如，车辆太老而不能承保，或被保险人的历史记录非常糟糕)。
在一份保单的所有保险险种都经过评级人员团队的评级和批准后，最后一步是由一组承保人(可能包括不止一个承保人)承保(批准)该保单。并非所有的政策都将不经修改而获得批准。承销商团队可能会选择拒绝某些保单。在这种情况下，代理将在作出任何修改前与被保险人协商。代理、评级、承销商均为本公司员工。虽然工作人员可以从公司购买一份保单，但保险单的投保方都不能是该保单的代理人、评级人或保险人。
当保单被承销商团队拒绝时，代理可以与客户讨论，然后提交更新的保险范围或客户资格，进行新一轮评级和承保。因此，承销和评级的程序可能由同一或不同的工作人员进行几轮(可能在同一或不同的日期)。保单承保后，假定客户支付费用，保单将被执行。

1. Person存储个人详细信息。
客户和员工都是专业化的人。
人可以包括既不是客户也不是员工的人。
2. Policy记录策略的详细信息。
这里，ptype取4个值中的一个——G、C、T和p。这4个值对应于四种不同的保单类型——Greenslip、综合保险、第三方保险和保费选项，其中保费选项是完全可定制的保单，可以包括任何险种。
effectivedate和expirydate属性指定策略激活的时间。
协议价值属性表示如果被保险的汽车发生全损，公司将支付给客户的金额。
属性状态采用6个值中的一个- D, RR, AR, RU, AU, E。这些对应于政策处理的6种可能的状态:一旦政策起草，它的状态是d，然后，政策被发送给评级团队;根据评级结果将状态设置为RR或AR;AR表示批准，RR表示拒绝。最后，保单被发送到保险商团队，AU表示批准，RU表示拒绝。一旦保险单被承保，它将被强制执行;因此，状态被设置为E。
3.Underwriting_record显示每个承保的详细信息，其中状态取可能的三个值之一，R、A、W和o。这些值对应拒绝、批准、等待(待批准)和过期/过时的批准。当保单进行新一轮承保时，先前的保单审批将更新为O。因此，在几轮保单承保之后，可能会出现多次拒绝、等待或过期的保单批准。然而，最多只能有一个成功的批准。
4. Rating_record中的属性状态与Underwriting_record中的类似。Rating_record中的属性rate告诉客户为获得相应的覆盖需要支付多少钱。
5. 覆盖率存储覆盖率的详细信息。属性cname描述覆盖类型(例如，第三方保险)。maxamount属性指定公司将在保险范围内支付给客户的最大金额。
6. insurred_item存储被保险车辆的详细信息。


1. 列出所有既不是客户也不是员工的人。将结果按pid升序排序。
2. 列出所有从未投保(全部或共同)本公司强制保险的人员(包括员工和客户)。将结果按pid升序排序。
3.对于每个汽车品牌，列出最昂贵的保险单(保险费，即其批准的保险费率的总和)投保的车辆。只包括过去和当前执行的政策。将结果按品牌排序，然后按车辆id排序，如果有tie则按pno排序，所有的排序顺序都是升序的。
4. 列出所有没有销售、定价或承保任何最终强制执行的保单的员工。请注意,政策。sid记录了出售保单的员工(即代理)。将结果按pid(即Persion id)升序排序。
5. 对于新南威尔士州的每个郊区(通过郊区名称)，计算已出售给居住在郊区的投保人的强制保单数量(无论保单的有效日期和到期日期)。将结果按策略数量(npolicies)排序，然后按郊区排序，升序排列。不包括没有出售保单的郊区。此外，郊区名称以全大写形式输出。
6. 查找所有过去和当前执行的政策，这些政策是由同一名工作人员进行评级、承保和销售的，而不涉及任何其他人。将结果按pno升序排序。
7. 公司希望加快批准保单的周期，并希望找到从对保单进行评级的第一评级人(无论评级状态如何)到批准保单的最后一家承保人之间时间最长的强制保单。找到这样一个策略(如果有多个策略具有相同的最长时间，则有多个策略)，并输出下面指定的详细信息。将结果按pno升序排序。
8. 列出成功销售只覆盖一个品牌汽车的保单(即强制保单)的员工(他们的姓名、一个空格和一个姓作为一个名为name的列)。将结果按pid升序排序。
9. 列出持有覆盖数据库中记录的所有汽车品牌的保单的客户(他们的名字、一个空格和姓氏作为一个名为name的列)。忽略策略状态，包括过去和当前的策略。将结果按pid升序排序。
10. 创建一个函数，返回在给定策略上工作(例如，销售、费率、承保)的(不同的)员工总数(忽略其状态)。如果给定的策略号不存在策略，则返回0。
11. 创建一个存储过程，该存储过程将开始更新数据库中的现有策略。
该过程将包含一个保单号码。如果政策执行,仍然有效,它将创建一个新的政策在政策表与相同的策略类型,agreedvalue,评论,但状态设置为D, effectivedate设置为今天的日期,和expirydate就等于“今天”+(“老expirydate”-“老effectivedate”)。换句话说，它将具有与以前相同的有效期限。此外，它还会将旧的expirydate更新为今天的日期(以结束旧的保单)。最后，将在新创建的策略的Coverage表中创建相同的覆盖率集(具有相同的cname、maxamount和注释)。这些新创建的保险和政策将被传递给评价者和保险商以获得批准。
如果给定的策略目前没有生效(例如，draft, rejected, expired，等等)，在策略表中创建一个新的策略，但是您没有将旧的过期日期设置为今天的日期。类似地，在新创建的策略的Coverage表中将创建相同的覆盖率集(具有相同的cname、maxamount和注释)。这些新创建的保险和政策将随后传递给评级人和保险商以获得批准。如果给定的策略号不存在策略，则不执行任何操作。如果对于给定的保单编号，同一车辆存在另一个当前有效的(即执行并至今仍有效的)相同保单类型的保单，也不做任何操作。
12. 工作人员可以从该公司购买保险单，但保险单的投保方都不能是该保险单的代理人、评级人或保险人。
创建一个触发器(或多个触发器)来执行此约束，同时允许工作人员购买策略。